import { RbacPlugin } from '@teliagen/plugin-rbac';
import { User } from '@teliagen/plugin-identity/modules/app/index.js';
{{#if authEnabled}}
import { authPlugin } from './auth.plugin.js';
{{/if}}

export const rbacPlugin = RbacPlugin({
name: 'rbac',
actionsPrefix: 'v1',
{{#if authEnabled}}
// Link to auth guard for protected actions
auth: {
guard: authPlugin.Guard
},
{{/if}}

// Link to subject (User entity from identity)
subject: User as any,

// Default permissions
defaultPermissions: [
{ code: 'admin:access', title: 'Admin Access', description: 'Access to admin panel' },
{ code: 'user:read', title: 'Read Users', description: 'Can view users' },
{ code: 'user:write', title: 'Write Users', description: 'Can create/edit users' },
{ code: 'user:delete', title: 'Delete Users', description: 'Can delete users' }
],

// Default roles
defaultRoles: [
{
code: 'admin',
title: 'Administrator',
description: 'Full access to the system',
priority: 100,
permissions: ['admin:access', 'user:read', 'user:write', 'user:delete']
},
{
code: 'user',
title: 'User',
description: 'Basic user access',
priority: 10,
permissions: ['user:read']
}
]
});